{"paragraphs":[{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1516032755352_-764518469","id":"20180115-161235_420242568","dateCreated":"2018-01-15T16:12:35+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:23253"},{"text":"println(\"Spark version \" + sc.version)\n// println(\"Scala version \" + util.Properties.versionString)\n\n// Global variables\nval dir_data = \"data/dev-test-exploratory-analysis\"\nval fngram = dir_data + \"/224564804326967_facebook_comments_ngram\"\n// End of Global variables\n\n// Read text file\nval ngramsDF = spark.read\n  .format(\"csv\").load(fngram).toDF(\"ngram\", \"ngram_frequency\")\n","user":"anonymous","dateUpdated":"2018-01-14T17:21:43+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Spark version 2.1.0\n\ndir_data: String = data/dev-test-exploratory-analysis\n\nfngram: String = data/dev-test-exploratory-analysis/224564804326967_facebook_comments_ngram\n\nngramsDF: org.apache.spark.sql.DataFrame = [ngram: string, ngram_frequency: string]\n"}]},"apps":[],"jobName":"paragraph_1515860840898_-320674794","id":"20180113-162720_943405646","dateCreated":"2018-01-13T16:27:20+0000","dateStarted":"2018-01-14T17:21:46+0000","dateFinished":"2018-01-14T17:21:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:23254"},{"text":"ngramsDF.filter($\"ngram_frequency\" > 10).show()","user":"anonymous","dateUpdated":"2018-01-14T17:21:43+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------+---------------+\n|         ngram|ngram_frequency|\n+--------------+---------------+\n|lidl slovensko|           25.0|\n|        byt on|           16.0|\n|    super cena|           15.0|\n|     byt kupit|           13.0|\n|      toto byt|           12.0|\n+--------------+---------------+\n\n"}]},"apps":[],"jobName":"paragraph_1515937511394_1278002123","id":"20180114-134511_1438064126","dateCreated":"2018-01-14T13:45:11+0000","dateStarted":"2018-01-14T17:21:47+0000","dateFinished":"2018-01-14T17:21:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:23255"},{"text":"// Prepare vertex data\n\n// val zipUDF = udf { (terms: Seq[String], probabilities: Seq[Double]) => terms.zip(probabilities) }\nval arrUDF = udf {(v: String) => Array(v.mkString)}\nval vertexArr = vertexDF\n    .withColumn(\"v0_arr\", arrUDF(col(\"v0\")))\n    .withColumn(\"v1_arr\", arrUDF(col(\"v1\")))\n\n","user":"anonymous","dateUpdated":"2018-01-14T17:21:44+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\narrUDF: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,ArrayType(StringType,true),Some(List(StringType)))\n\nvertexArr: org.apache.spark.sql.DataFrame = [v0: string, v1: string ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1515872128087_419809408","id":"20180113-193528_2346804","dateCreated":"2018-01-13T19:35:28+0000","dateStarted":"2018-01-14T17:22:01+0000","dateFinished":"2018-01-14T17:22:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:23256"},{"text":"val vertexMap = vertexTmp.select(\n  col(\"v0WithIndex._1\").as(\"v0term\"),\n  col(\"v1WithIndex._1\").as(\"v1term\"),\n  col(\"v0WithIndex._2\").as(\"v0num\"),\n  col(\"v1WithIndex._2\").as(\"v1num\"),\n  col(\"weight\"))\n  .orderBy(desc(\"weight\"))\n\n// vertexDF.filter($\"weight\" > 10).show()","user":"anonymous","dateUpdated":"2018-01-14T17:59:14+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nvertexMap: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [v0term: string, v1term: string ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1515874774374_355725432","id":"20180113-201934_1671225228","dateCreated":"2018-01-13T20:19:34+0000","dateStarted":"2018-01-14T17:59:14+0000","dateFinished":"2018-01-14T17:59:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:23257"},{"text":"vertexTmp.select(\n  col(\"v0WithIndex._1\").as(\"v0term\"),\n  col(\"v1WithIndex._1\").as(\"v1term\"),\n  col(\"v0WithIndex._2\").as(\"v0num\"),\n  col(\"v1WithIndex._2\").as(\"v1num\"),\n  col(\"weight\"))\n  .orderBy(desc(\"weight\")).show()","user":"anonymous","dateUpdated":"2018-01-14T17:55:54+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------+-----+-----+------+\n| v0term|v1term|v0num|v1num|weight|\n+-------+------+-----+-----+------+\n| prosit|   vas|   56|   12|   9.0|\n|      u|   vas|   27|   12|   9.0|\n|  dobry|   den|   79|  137|   9.0|\n|   kriz| nebyt|    7|   17|   8.0|\n|    byt| super|    0|   66|   8.0|\n|    byt|   vas|    0|   12|   7.0|\n|    zly|   byt|   95|    0|   7.0|\n|    aky|   byt|   40|    0|   7.0|\n|vajicko|   byt|    8|    0|   7.0|\n|   mily|  lidl|  211|    6|   7.0|\n|    byt|   tam|    0|   23|   6.0|\n|    byt|  taky|    0|   29|   6.0|\n|  kupit|   byt|   10|    0|   6.0|\n|   cena| vajce|    1|    4|   6.0|\n|  ktory|   byt|   38|    0|   6.0|\n|   dnes|   byt|  119|    0|   6.0|\n|   lidl|   byt|    6|    0|   6.0|\n|  preto|   byt|  126|    0|   6.0|\n|    byt|  vzdy|    0|  134|   6.0|\n|    byt|chciet|    0|   30|   6.0|\n+-------+------+-----+-----+------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1515952543346_-504404158","id":"20180114-175543_1775509762","dateCreated":"2018-01-14T17:55:43+0000","dateStarted":"2018-01-14T17:55:54+0000","dateFinished":"2018-01-14T17:56:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:23258"},{"text":"// Compute the highest degree vertex\n// Define a reduce operation to compute the highest degree vertex\ndef max(a: (VertexId, Int), b: (VertexId, Int)): (VertexId, Int) = {\n if (a._2 > b._2) a else b\n}\nval maxInDegree: (VertexId, Int) = graphDat.inDegrees.reduce(max)\nmaxInDegree\nval maxOutDegree: (VertexId, Int) = graphDat.outDegrees.reduce(max)\nmaxOutDegree\nval maxDegrees: (VertexId, Int) = graphDat.degrees.reduce(max)\nmaxDegrees\n","user":"anonymous","dateUpdated":"2018-05-07T08:45:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nmax: (a: (org.apache.spark.graphx.VertexId, Int), b: (org.apache.spark.graphx.VertexId, Int))(org.apache.spark.graphx.VertexId, Int)\n\nmaxInDegree: (org.apache.spark.graphx.VertexId, Int) = (0,285)\n\nres270: (org.apache.spark.graphx.VertexId, Int) = (0,285)\n\nmaxOutDegree: (org.apache.spark.graphx.VertexId, Int) = (0,286)\n\nres271: (org.apache.spark.graphx.VertexId, Int) = (0,286)\n\nmaxDegrees: (org.apache.spark.graphx.VertexId, Int) = (0,571)\n\nres272: (org.apache.spark.graphx.VertexId, Int) = (0,571)\n"}]},"apps":[],"jobName":"paragraph_1515956255842_-172582409","id":"20180114-185735_1875916901","dateCreated":"2018-01-14T18:57:35+0000","dateStarted":"2018-01-14T19:00:26+0000","dateFinished":"2018-01-14T19:00:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:23259"},{"text":"vertexMap.filter(\"v1num == 285\")\n         .show()","user":"anonymous","dateUpdated":"2018-01-15T15:32:12+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+------+-----+-----+------+\n|   v0term|v1term|v0num|v1num|weight|\n+---------+------+-----+-----+------+\n|nekupovat|  pojd|  158|  285|   1.0|\n|  vajicko|  pojd|    8|  285|   1.0|\n|     cena|  pojd|    1|  285|   1.0|\n+---------+------+-----+-----+------+\n\n"}]},"apps":[],"jobName":"paragraph_1515956256691_-191435105","id":"20180114-185736_1089576325","dateCreated":"2018-01-14T18:57:36+0000","dateStarted":"2018-01-15T15:32:12+0000","dateFinished":"2018-01-15T15:32:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:23260"},{"text":"vertexMap.filter(\"v1num == 286\")\n         .show()","user":"anonymous","dateUpdated":"2018-01-15T15:32:00+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------+-----+-----+------+\n| v0term|v1term|v0num|v1num|weight|\n+-------+------+-----+-----+------+\n|hranica| najst|  433|  286|   1.0|\n|    vas| najst|   12|  286|   1.0|\n|  nieco| najst|  154|  286|   1.0|\n|    kde| najst|   96|  286|   1.0|\n+-------+------+-----+-----+------+\n\n"}]},"apps":[],"jobName":"paragraph_1515956257306_-1156370022","id":"20180114-185737_750969389","dateCreated":"2018-01-14T18:57:37+0000","dateStarted":"2018-01-15T15:32:00+0000","dateFinished":"2018-01-15T15:32:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:23261"},{"text":"vertexMap.filter(\"v0num == 571\")\n         .show()","user":"anonymous","dateUpdated":"2018-01-15T15:31:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+-------+-----+-----+------+\n|v0term| v1term|v0num|v1num|weight|\n+------+-------+-----+-----+------+\n| jedlo|    kde|  571|   96|   1.0|\n| jedlo|auticko|  571|  229|   1.0|\n+------+-------+-----+-----+------+\n\n"}]},"apps":[],"jobName":"paragraph_1515956257817_-1354515706","id":"20180114-185737_520438816","dateCreated":"2018-01-14T18:57:37+0000","dateStarted":"2018-01-15T15:31:58+0000","dateFinished":"2018-01-15T15:32:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:23262"},{"text":"vertexMap.filter(\"v0num == 0\").show()\n\nvertexMap.filter(\"v1num == 0\").show()","user":"anonymous","dateUpdated":"2018-01-15T15:44:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+---------+-----+-----+------+\n|v0term|   v1term|v0num|v1num|weight|\n+------+---------+-----+-----+------+\n|   byt|    super|    0|   66|   8.0|\n|   byt|      vas|    0|   12|   7.0|\n|   byt|     taky|    0|   29|   6.0|\n|   byt|      tam|    0|   23|   6.0|\n|   byt| vyjadrit|    0|  216|   6.0|\n|   byt|   chciet|    0|   30|   6.0|\n|   byt|     vzdy|    0|  134|   6.0|\n|   byt|        u|    0|   27|   5.0|\n|   byt|   pravda|    0|   84|   5.0|\n|   byt|slovensky|    0|   15|   4.0|\n|   byt|      zly|    0|   95|   4.0|\n|   byt|     este|    0|   11|   4.0|\n|   byt|     fakt|    0|  118|   4.0|\n|   byt|  mysliet|    0|  109|   4.0|\n|   byt|zaujimavy|    0|  233|   4.0|\n|   byt|       ta|    0|    3|   4.0|\n|   byt|      rad|    0|   33|   4.0|\n|   byt|    dobre|    0|  130|   4.0|\n|   byt|    umelo|    0|  140|   3.0|\n|   byt|   vidiet|    0|   91|   3.0|\n+------+---------+-----+-----+------+\nonly showing top 20 rows\n\n+---------+------+-----+-----+------+\n|   v0term|v1term|v0num|v1num|weight|\n+---------+------+-----+-----+------+\n|      zly|   byt|   95|    0|   7.0|\n|  vajicko|   byt|    8|    0|   7.0|\n|      aky|   byt|   40|    0|   7.0|\n|     lidl|   byt|    6|    0|   6.0|\n|     cena|   byt|    1|    0|   6.0|\n|    ktory|   byt|   38|    0|   6.0|\n|    preto|   byt|  126|    0|   6.0|\n|     dnes|   byt|  119|    0|   6.0|\n|    kupit|   byt|   10|    0|   6.0|\n|   chciet|   byt|   30|    0|   6.0|\n|    teraz|   byt|  157|    0|   4.0|\n|      kde|   byt|   96|    0|   4.0|\n|    letak|   byt|   14|    0|   4.0|\n|slovensky|   byt|   15|    0|   4.0|\n|   vsetok|   byt|   19|    0|   4.0|\n|       on|   byt|    2|    0|   4.0|\n|       ta|   byt|    3|    0|   4.0|\n|     stat|   byt|   71|    0|   3.0|\n|   odkedy|   byt|  347|    0|   3.0|\n|     este|   byt|   11|    0|   3.0|\n+---------+------+-----+-----+------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1516021653877_-866778633","id":"20180115-130733_2069697081","dateCreated":"2018-01-15T13:07:33+0000","dateStarted":"2018-01-15T15:44:59+0000","dateFinished":"2018-01-15T15:45:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:23263"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1516034430893_1044761851","id":"20180115-164030_2011443064","dateCreated":"2018-01-15T16:40:30+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:23264"}],"name":"2018W03.graph","id":"2D364JAZY","angularObjects":{"2DFT4J7KV:shared_process":[],"2DDWZB72Q:shared_process":[],"2DDK5964B:shared_process":[],"2DDHK9HNW:shared_process":[],"2DFB84U7B:shared_process":[],"2DECAAC84:shared_process":[],"2DETMSZZQ:shared_process":[],"2DC8KX6CH:shared_process":[],"2DFNP3ES2:shared_process":[],"2DCK5TH27:shared_process":[],"2DCUS6WPN:shared_process":[],"2DEAAUVXC:shared_process":[],"2DEZQ56CK:shared_process":[],"2DESW37TZ:shared_process":[],"2DD9GMSP4:shared_process":[],"2DDB2SSEJ:shared_process":[],"2DEAMKFHQ:shared_process":[],"2DERPV2ZZ:shared_process":[],"2DFT6RP6P:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}